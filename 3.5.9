SELECT name_program, name_enrollee, SUM(result) AS itog
FROM enrollee
INNER JOIN program_enrollee USING(enrollee_id)
INNER JOIN program USING(program_id)
INNER JOIN program_subject USING(program_id)
INNER JOIN subject USING(subject_id)
INNER JOIN enrollee_subject USING(subject_id, enrollee_id)
GROUP BY name_program, name_enrollee
ORDER BY 1, 3 DESC;
