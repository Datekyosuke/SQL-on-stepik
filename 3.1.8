SELECT name_subject, concat((SUBSTRING(name_question, 1, 30)) , '...') AS Вопрос, COUNT(testing.question_id) AS Всего_ответов, ROUND(100*(SUM(is_correct)/COUNT(is_correct)),2) AS Успешность
FROM subject
    INNER JOIN question  USING(subject_id)
    INNER JOIN testing  USING(question_id)
    INNER JOIN answer  USING(answer_id)
GROUP BY 1,2
ORDER BY 1, 4 DESC, 2;
